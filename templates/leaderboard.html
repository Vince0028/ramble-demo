{% extends 'base.html' %}
{% block content %}
  <div id="root"></div>
{% endblock %}
{% block scripts %}
{% raw %}
<script type="text/babel">
  const { useState, useEffect } = React;

  function Leaderboard() {
    const [selectedPeriod, setSelectedPeriod] = useState('week');

    const leaderboardData = [
      { name: 'Qelvin N.', points: 6900, initial: 'Q', rank: 1, badge: 'üèÜ' },
      { name: 'Rick C.', points: 4200, initial: 'R', rank: 2, badge: 'ü•à' },
      { name: 'Sarah M.', points: 2880, initial: 'S', rank: 3, badge: 'ü•â' },
      { name: 'Mike R.', points: 2720, initial: 'M', rank: 4, badge: '' },
      { name: 'Marwin G.', points: 2690, initial: 'M', rank: 5, badge: '' },
      { name: 'Alex (You)', points: 2690, initial: 'A', rank: 4, badge: '', isCurrentUser: true },
      { name: 'Christian B.', points: 2100, initial: 'C', rank: 7, badge: '' },
      { name: 'Vince A.', points: 1950, initial: 'V', rank: 8, badge: '' },
      { name: 'Carl B.', points: 1800, initial: 'C', rank: 9, badge: '' },
      { name: 'John D.', points: 1650, initial: 'J', rank: 10, badge: '' },
    ];

    const periods = [
      { key: 'day', label: 'Today' },
      { key: 'week', label: 'This Week' },
      { key: 'month', label: 'This Month' },
      { key: 'all', label: 'All Time' },
    ];

    useEffect(() => { if (window.lucide) window.lucide.createIcons(); });

    const RankIcon = ({ rank }) => {
      switch (rank) {
        case 1: return <i data-lucide="crown" className="w-5 h-5 text-yellow-500"></i>;
        case 2: return <i data-lucide="medal" className="w-5 h-5 text-gray-400"></i>;
        case 3: return <i data-lucide="award" className="w-5 h-5 text-orange-500"></i>;
        default: return <span className="text-lg font-bold text-gray-600">#{rank}</span>;
      }
    };

    return (
      <div className="min-h-screen bg-gray-50 pb-24">
        {/* Header */}
        <div className="bg-blue-900 text-white p-4">
          <div className="flex items-center justify-between">
            <h1 className="text-xl font-bold flex items-center gap-2">
              <i data-lucide="trophy" className="w-6 h-6"></i>
              Leaderboard
            </h1>
          </div>
        </div>

        <div className="p-4 space-y-4">
          {/* Period Selector */}
          <div className="p-4 bg-white rounded-xl border">
            <div className="flex gap-2 overflow-x-auto">
              {periods.map(period => (
                <button key={period.key}
                        onClick={() => setSelectedPeriod(period.key)}
                        className={`px-3 py-1.5 rounded-md text-sm ${selectedPeriod===period.key ? 'bg-yellow-400 hover:bg-yellow-500 text-black' : 'border border-gray-300'}`}>
                  {period.label}
                </button>
              ))}
            </div>
          </div>

          {/* Top 3 Podium */}
          <div className="p-6 bg-white rounded-xl border">
            <h3 className="font-semibold mb-4 text-center">Top RAMblers</h3>
            <div className="flex justify-center items-end gap-4 mb-6">
              {/* 2nd */}
              <div className="text-center">
                <div className="w-16 h-16 bg-gray-400 rounded-full flex items-center justify-center text-white text-xl font-bold mb-2">{leaderboardData[1].initial}</div>
                <div className="text-2xl mb-1">ü•à</div>
                <div className="font-semibold text-sm">{leaderboardData[1].name}</div>
                <div className="text-xs text-gray-600">{leaderboardData[1].points.toLocaleString()}</div>
              </div>
              {/* 1st */}
              <div className="text-center">
                <div className="w-20 h-20 bg-yellow-500 rounded-full flex items-center justify-center text-white text-2xl font-bold mb-2">{leaderboardData[0].initial}</div>
                <div className="text-3xl mb-1">üèÜ</div>
                <div className="font-bold">{leaderboardData[0].name}</div>
                <div className="text-sm text-gray-600">{leaderboardData[0].points.toLocaleString()}</div>
              </div>
              {/* 3rd */}
              <div className="text-center">
                <div className="w-16 h-16 bg-orange-500 rounded-full flex items-center justify-center text-white text-xl font-bold mb-2">{leaderboardData[2].initial}</div>
                <div className="text-2xl mb-1">ü•â</div>
                <div className="font-semibold text-sm">{leaderboardData[2].name}</div>
                <div className="text-xs text-gray-600">{leaderboardData[2].points.toLocaleString()}</div>
              </div>
            </div>
          </div>

          {/* Full Rankings */}
          <div className="p-4 bg-white rounded-xl border">
            <h3 className="font-semibold mb-4">Full Rankings</h3>
            <div className="space-y-3">
              {leaderboardData.map((user, index) => (
                <div key={index} className={`flex items-center justify-between p-3 rounded-lg ${user.isCurrentUser ? 'bg-blue-50 border-2 border-blue-200' : 'bg-white border border-gray-200'}`}>
                  <div className="flex items-center gap-3">
                    <div className="w-8 h-8 flex items-center justify-center"><RankIcon rank={user.rank} /></div>
                    <div className={`w-10 h-10 rounded-full flex items-center justify-center text-white font-medium ${user.rank===1 ? 'bg-yellow-500' : user.rank===2 ? 'bg-gray-400' : user.rank===3 ? 'bg-orange-500' : (user.isCurrentUser ? 'bg-blue-500' : ['bg-pink-400','bg-green-400','bg-purple-400','bg-indigo-400','bg-red-400','bg-teal-400'][index%6])}`}>
                      {user.initial}
                    </div>
                    <div>
                      <div className={`font-medium ${user.isCurrentUser ? 'text-blue-700' : ''}`}>
                        {user.name} {user.isCurrentUser && <span className="ml-2 text-xs px-2 py-0.5 rounded bg-blue-100 text-blue-800">You</span>}
                      </div>
                      <div className="text-sm text-gray-600">{user.points.toLocaleString()} Ram Points</div>
                    </div>
                  </div>
                  <div className="text-right">
                    {user.badge && <div className="text-2xl">{user.badge}</div>}
                    {user.rank <= 3 && (
                      <span className={`text-xs px-2 py-0.5 rounded ${user.rank===1 ? 'bg-yellow-100 text-yellow-800' : user.rank===2 ? 'bg-gray-100 text-gray-800' : 'bg-orange-100 text-orange-800'}`}>Top {user.rank}</span>
                    )}
                  </div>
                </div>
              ))}
            </div>
          </div>

          {/* Stats Card */}
          <div className="p-4 bg-white rounded-xl border">
            <h3 className="font-semibold mb-4">Your Stats</h3>
            <div className="grid grid-cols-2 gap-4">
              <div className="text-center p-3 bg-blue-50 rounded-lg">
                <div className="text-2xl font-bold text-blue-600">#4</div>
                <div className="text-sm text-gray-600">Current Rank</div>
              </div>
              <div className="text-center p-3 bg-orange-50 rounded-lg">
                <div className="text-2xl font-bold text-orange-600">2,690</div>
                <div className="text-sm text-gray-600">Total Points</div>
              </div>
            </div>
          </div>
        </div>
        {/* Spacer to ensure content can scroll above fixed bottom nav */}
        <div aria-hidden="true" style={{ height: 'var(--bottom-nav-height)' }}></div>

        {/* Bottom Navigation (fixed at viewport bottom) */}
        <div className="fixed bottom-0 left-0 right-0 bg-yellow-400 p-2 h-16 z-40" data-bottom-nav>
          <div className="flex justify-around items-center">
            <button className="flex flex-col items-center gap-1 text-black p-2 rounded hover:bg-black/10" onClick={() => window.location.assign('/dashboard')}>
              <i data-lucide="home" className="w-5 h-5"></i>
              <span className="text-xs">HOME</span>
            </button>
            <button className="flex flex-col items-center gap-1 text-black p-2 rounded hover:bg-black/10" onClick={()=>window.location.assign('/groups')}>
              <i data-lucide="users" className="w-5 h-5"></i>
              <span className="text-xs">GROUPS</span>
            </button>
            <button className="flex flex-col items-center gap-1 text-black p-2 rounded hover:bg-black/10" onClick={()=>window.location.assign('/chat')}>
              <i data-lucide="message-circle" className="w-5 h-5"></i>
              <span className="text-xs">CHAT</span>
            </button>
            <button className="flex flex-col items-center gap-1 text-black p-2 rounded bg-black/10">
              <i data-lucide="trophy" className="w-5 h-5"></i>
              <span className="text-xs">BOARD</span>
            </button>
            <button className="flex flex-col items-center gap-1 text-black p-2 rounded hover:bg-black/10" onClick={()=>window.location.assign('/profile')}>
              <i data-lucide="user" className="w-5 h-5"></i>
              <span className="text-xs">PROFILE</span>
            </button>
          </div>
        </div>
      </div>
    );
  }

  ReactDOM.createRoot(document.getElementById('root')).render(<Leaderboard/>);
</script>
{% endraw %}
{% endblock %}
