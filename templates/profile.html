{% extends 'base.html' %}
{% block content %}
  <div id="root"></div>
{% endblock %}
{% block scripts %}
{% raw %}
<script type="text/babel">
  const { useEffect, useState } = React;

  function Profile() {
    const [user, setUser] = useState(null);

    useEffect(() => {
      const userData = localStorage.getItem('ramble_user');
      if (userData) {
        setUser(JSON.parse(userData));
      } else {
        window.location.assign('/');
      }
    }, []);

    useEffect(() => { if (window.lucide) window.lucide.createIcons(); });

    const achievements = [
      { name: 'First Connection', icon: 'ü§ù', earned: true },
      { name: 'Chat Master', icon: 'üí¨', earned: true },
      { name: 'Challenge Crusher', icon: '‚ö°', earned: false },
      { name: 'Networking Ninja', icon: 'ü•∑', earned: false },
    ];

    const interests = ['AI & Machine Learning', 'Startup Ecosystem', 'No-Code Tools', 'Design Thinking'];

    const recentConnections = [
      { name: 'Sarah M.', role: 'UX Designer', mutual: 2 },
      { name: 'Mike R.', role: 'Full Stack Dev', mutual: 1 },
      { name: 'Qelvin N.', role: 'AI Researcher', mutual: 3 },
    ];

    if (!user) return null;

    return (
      <div className="min-h-screen bg-gray-50 pb-24">
        {/* Header */}
        <div className="bg-blue-900 text-white p-4">
          <div className="flex items-center justify-between">
            <h1 className="text-xl font-bold">Profile</h1>
            <button className="p-2 rounded hover:bg-white/10" aria-label="Settings">
              <i data-lucide="settings" className="w-5 h-5"></i>
            </button>
          </div>
        </div>

        <div className="p-4 space-y-4">
          {/* Profile Card */}
          <div className="p-6 text-center bg-white rounded-xl border">
            <div className="w-20 h-20 bg-blue-500 rounded-full flex items-center justify-center text-white text-2xl font-bold mx-auto mb-4">
              {user.name.charAt(0)}
            </div>
            <h2 className="text-xl font-bold mb-1">{user.name}</h2>
            <p className="text-gray-600 mb-4">{user.email}</p>

            <div className="grid grid-cols-3 gap-4 text-center">
              <div>
                <div className="text-2xl font-bold text-blue-600">#{user.rank}</div>
                <div className="text-sm text-gray-600">Rank</div>
              </div>
              <div>
                <div className="text-2xl font-bold text-orange-500">{user.points.toLocaleString()}</div>
                <div className="text-sm text-gray-600">Points</div>
              </div>
              <div>
                <div className="text-2xl font-bold text-green-500">12</div>
                <div className="text-sm text-gray-600">Connections</div>
              </div>
            </div>
          </div>

          {/* Achievements */}
          <div className="p-4 bg-white rounded-xl border">
            <h3 className="font-semibold mb-4 flex items-center gap-2">
              <i data-lucide="award" className="w-5 h-5"></i>
              Achievements
            </h3>
            <div className="grid grid-cols-2 gap-3">
              {achievements.map((a, i) => (
                <div key={i} className={`p-3 rounded-lg border text-center ${a.earned ? 'bg-yellow-50 border-yellow-200' : 'bg-gray-50 border-gray-200 opacity-50'}`}>
                  <div className="text-2xl mb-1">{a.icon}</div>
                  <div className="text-xs font-medium">{a.name}</div>
                </div>
              ))}
            </div>
          </div>

          {/* Interests */}
          <div className="p-4 bg-white rounded-xl border">
            <h3 className="font-semibold mb-4 flex items-center gap-2">
              <i data-lucide="star" className="w-5 h-5"></i>
              Interests
            </h3>
            <div className="flex flex-wrap gap-2">
              {interests.map((interest, index) => (
                <span key={index} className="text-xs px-2 py-1 rounded bg-blue-100 text-blue-800">{interest}</span>
              ))}
            </div>
          </div>

          {/* Recent Connections */}
          <div className="p-4 bg-white rounded-xl border">
            <h3 className="font-semibold mb-4 flex items-center gap-2">
              <i data-lucide="users" className="w-5 h-5"></i>
              Recent Connections
            </h3>
            <div className="space-y-3">
              {recentConnections.map((c, i) => (
                <div key={i} className="flex items-center justify-between">
                  <div className="flex items-center gap-3">
                    <div className={`w-10 h-10 rounded-full flex items-center justify-center text-white font-medium ${['bg-pink-400','bg-blue-400','bg-green-400'][i]}`}>{c.name.charAt(0)}</div>
                    <div>
                      <div className="font-medium">{c.name}</div>
                      <div className="text-sm text-gray-600">{c.role}</div>
                    </div>
                  </div>
                  <div className="text-xs text-gray-500">{c.mutual} mutual</div>
                </div>
              ))}
            </div>
          </div>

          {/* Event History */}
          <div className="p-4 bg-white rounded-xl border">
            <h3 className="font-semibold mb-4">Event History</h3>
            <div className="space-y-3">
              <div className="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                <div>
                  <div className="font-medium">AI Innovators Summit</div>
                  <div className="text-sm text-gray-600">Sept 21, 2025</div>
                </div>
                <span className="text-xs px-2 py-0.5 rounded bg-green-100 text-green-800">Completed</span>
              </div>
              <div className="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                <div>
                  <div className="font-medium">Tech Startup Mixer</div>
                  <div className="text-sm text-gray-600">Sept 15, 2025</div>
                </div>
                <span className="text-xs px-2 py-0.5 rounded bg-green-100 text-green-800">Completed</span>
              </div>
            </div>
          </div>
        </div>

        {/* Spacer to ensure content can scroll above fixed bottom nav */}
        <div aria-hidden="true" className="h-20"></div>

        {/* Bottom Navigation (fixed at viewport bottom) */}
        <div className="fixed bottom-0 left-0 right-0 bg-yellow-400 p-2 h-16 z-40">
          <div className="flex justify-around items-center">
            <button className="flex flex-col items-center gap-1 text-black p-2 rounded hover:bg-black/10" onClick={() => window.location.assign('/dashboard')}>
              <i data-lucide="home" className="w-5 h-5"></i>
              <span className="text-xs">HOME</span>
            </button>
            <button className="flex flex-col items-center gap-1 text-black p-2 rounded hover:bg-black/10" onClick={()=>window.location.assign('/groups')}>
              <i data-lucide="users" className="w-5 h-5"></i>
              <span className="text-xs">GROUPS</span>
            </button>
            <button className="flex flex-col items-center gap-1 text-black p-2 rounded hover:bg-black/10" onClick={()=>window.location.assign('/chat')}>
              <i data-lucide="message-circle" className="w-5 h-5"></i>
              <span className="text-xs">CHAT</span>
            </button>
            <button className="flex flex-col items-center gap-1 text-black p-2 rounded hover:bg-black/10" onClick={()=>window.location.assign('/leaderboard')}>
              <i data-lucide="trophy" className="w-5 h-5"></i>
              <span className="text-xs">BOARD</span>
            </button>
            <button className="flex flex-col items-center gap-1 text-black p-2 rounded bg-black/10">
              <i data-lucide="user" className="w-5 h-5"></i>
              <span className="text-xs">PROFILE</span>
            </button>
          </div>
        </div>
      </div>
    );
  }

  ReactDOM.createRoot(document.getElementById('root')).render(<Profile/>);
</script>
{% endraw %}
{% endblock %}
